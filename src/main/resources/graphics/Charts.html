<!DOCTYPE html>
<html>
<meta charset="UTF-8">

<head>
    <title>Charts</title>
    <link rel="stylesheet" type="text/css" href="../css/tabulator.css" />
    <link rel="stylesheet" type="text/css" href="../css/chart.css" />

    <script type="text/javascript" src="./lib/moment-with-locale.js"></script>
    <script type="text/javascript" src="./lib/Chart.js"></script>
    <script type="text/javascript" src="./lib/color-hash.js"></script>
    <script type="text/javascript" src="./lib/html2canvas.js"></script>
    <script type="text/javascript" src="./lib/apexcharts.js"></script>
    <script type="text/javascript" src="./lib/chartjs-chart-box-and-violin-plot.js"></script>
    <script type="text/javascript" src="./lib/chartjs-plugin-datalabels.js"></script>
    <script type="text/javascript" src="./lib/tabulator.js"></script>
    <script type="text/javascript" src="base.js"></script>


</head>

<div id="all_tabs" class="controles">

    <div id="tabs_options" class="opciones">
        <button value="Leyenda" class="btn" id="btnLegend" onclick="hideLegend()" />
        <button value="Media General" class="btn" id="btnMean" onclick="showGeneralMean()" />
        <button class="btn" id="btnGroupMean" onclick="showGroupMean()" />
    </div>
</div>

<div id="chart-container" class="chart-container">
    <canvas id="myChart"></canvas>
</div>
<div id="apexchartsDiv" class="apexchart-container"></div>
<div id="tabulatorDiv"></div>
 <script type="text/javascript">
 
     Chart.defaults.global.animation.duration = 0;
    Chart.defaults.global.elements.line.fill = false;
    Chart.defaults.global.elements.line.tension = 0;
    Chart.defaults.global.maintainAspectRatio = false;
    Chart.defaults.global.hover.animationDuration = 0;
    Chart.defaults.global.legend.labels.usePointStyle = true;
    Chart.defaults.global.legend.position = "top";
    Chart.defaults.global.onClick = function (event, array) {
        let element = myChart.getElementsAtEventForMode(event, "point", { intersect: false });
        if (element.length > 0) {
            javaConnector.dataPointSelection(element[counter % element.length]._datasetIndex);
            counter++;
        }
    };
    
    Chart.plugins.register({
	  beforeDraw: function(chartInstance) {
	    var ctx = chartInstance.chart.ctx;
	    ctx.fillStyle = chartInstance.config.options.chartBackgroundColor;
	    ctx.fillRect(0, 0, chartInstance.chart.width, chartInstance.chart.height);
	  }
	});

    Chart.defaults.scale.ticks.beginAtZero = true;
    Chart.defaults.scale.ticks.precision = 0;
    Chart.defaults.scale.ticks.suggestedMin = 0;
    Chart.defaults.scale.autoSkip = true;
    Chart.defaults.global.plugins.datalabels.display = false


    var counter = 0;
    var height = "93%";
    var locale = 'en-UK';
 
  	var colorHash;
	var ctx;
	var myChart;
	var myApexChart;
	var table;
  	
  	function createChartDivs(){
	  	  //------------------------------------------Variables globales-------------------------------------------------------------
	
	    //
	    colorHash = new ColorHash();
	    ctx = document.getElementById('myChart');
	
	    myChart = new Chart(ctx, {
	        type: "line",
	        data: {
	            labels: [],
	            datasets: []
	        },
	        options: {
	            tab: "grade_tabs",
	            button: "btnLine",
	            typeGraph: "line"
	        }
	    });
	
	    myApexChart = new ApexCharts(document.getElementById('apexchartsDiv'), { tab: "log_tabs", button: "btnHeatmap", typeGraph: "heatmap", tooltip: { x: { show: !0 } }, plotOptions: { heatmap: { enableShades: !1, colorScale: { ranges: [{ from: -1, to: 0, color: "#f78880", name: "0" }, { from: 1, to: 1, color: "#f4e3ae" }, { from: 1, to: 1, color: "#fff033" }, { from: 1, to: 1, color: "#b5ff33" }, { from: 1, to: 1, color: "#38e330" }, { from: 2, to: Number.POSITIVE_INFINITY, color: "#67b92e", name: "+2" }] } } }, legend: { position: "top" }, chart: { type: "heatmap", events: { dataPointSelection: function (o, e, t) { javaConnector.dataPointSelection(t.w.config.series.length - 1 - t.seriesIndex) } }, height: height, toolbar: { show: !1 }, animations: { enabled: !1 } }, dataLabels: { formatter: function (o, e) { return 0 == o ? "" : o }, style: { colors: ["#000000"] } }, colors: ["#00A100"], series: [], xaxis: { categories: [] } });
	    myApexChart.render();
	
	   	table = new Tabulator("#tabulatorDiv", {
	
	        tab: "activity_tabs",
	        button: "ACTIVITIES_TABLE",
	        invalidOptionWarnings: false,
	        height: height,
	        //placeholder: "No data",
	        tooltipsHeader: true,
	        virtualDom: true,
	        layout: "fitColumns", //fit columns to width of table (optional)
	        rowClick: function (e, row) {
	            javaConnector.dataPointSelection(row.getPosition());
	
	        },
	    });
  	}
</script>
</html>